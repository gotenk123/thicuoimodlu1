<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Qu·∫£n L√Ω S√°ch</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 16px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>
<h2>üìö Qu·∫£n l√Ω s√°ch</h2>
<button onclick="addBook()">‚ûï Th√™m s√°ch m·ªõi</button>

<table id="bookTable">
  <thead>
  <tr>
    <th>M√£ s√°ch</th>
    <th>T√™n s√°ch</th>
    <th>NƒÉm XB</th>
    <th>S·ªë quy·ªÉn</th>
    <th>T√¨nh tr·∫°ng</th>
  </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  class Book {
    constructor(code, name, year, quantity) {
      this.code = code;
      this.name = name;
      this.year = year;
      this.quantity = quantity;
      this.status = quantity > 0;
    }

    updateStatus() {
      this.status = this.quantity > 0;
    }

    getStatusText() {
      return this.status ? "‚úÖ C√≤n s√°ch" : "‚ùå H·∫øt s√°ch";
    }
  }

  const library = [];

  function validateCode(code) {
    return /^[1-5][0-9]{4}$/.test(code);
  }

  function validateYear(year) {
    return /^\d{4}$/.test(year) && Number(year) <= new Date().getFullYear();
  }

  function validateQuantity(quantity) {
    return /^\d+$/.test(quantity);
  }

  function addBook() {
    let code, name, year, quantity;

    do {
      code = prompt("Nh·∫≠p m√£ s√°ch (5 k√Ω t·ª±, b·∫Øt ƒë·∫ßu t·ª´ 1-5):");
      if (!validateCode(code)) alert("‚ùå M√£ s√°ch kh√¥ng h·ª£p l·ªá (vd: 10001)");
    } while (!validateCode(code));

    do {
      name = prompt("Nh·∫≠p t√™n s√°ch:");
      if (!name || name.trim() === "") alert("‚ùå T√™n s√°ch kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng.");
    } while (!name || name.trim() === "");

    do {
      year = prompt("Nh·∫≠p nƒÉm xu·∫•t b·∫£n (4 ch·ªØ s·ªë):");
      if (!validateYear(year)) alert("‚ùå NƒÉm xu·∫•t b·∫£n kh√¥ng h·ª£p l·ªá.");
    } while (!validateYear(year));

    do {
      quantity = prompt("Nh·∫≠p s·ªë quy·ªÉn:");
      if (!validateQuantity(quantity)) alert("‚ùå S·ªë quy·ªÉn ph·∫£i l√† s·ªë nguy√™n kh√¥ng √¢m.");
    } while (!validateQuantity(quantity));

    const book = new Book(code, name, Number(year), Number(quantity));
    library.push(book);
    alert("‚úÖ ƒê√£ th√™m s√°ch th√†nh c√¥ng!");
    displayBooks();
  }

  function displayBooks() {
    const tbody = document.querySelector("#bookTable tbody");
    tbody.innerHTML = ""; // X√≥a b·∫£ng c≈©

    library.forEach(book => {
      const row = document.createElement("tr");
      row.innerHTML = `
          <td>${book.code}</td>
          <td>${book.name}</td>
          <td>${book.year}</td>
          <td>${book.quantity}</td>
          <td>${book.getStatusText()}</td>
        `;
      tbody.appendChild(row);
    });
  }
</script>
</body>
</html>
